define("utils",["F"],function(b){var a=function(d){if(typeof d!=="undefined"){for(var c in d){if(typeof this[c]!=="undefined"){this[c]=d[c]}}}};a.prototype={commentBtnId:"js_comment_counts",commentConId:"cmtBox",topBtnId:"js_return_top",moveTime:200,moveCounts:20,topBtnDom:null,commentBtnDom:null,commentConDom:null,topFlag:false,commentFlag:false,isOpen:false,detail:{},commentUrl:"http://gentie.ifeng.com/view.html",init:function(){this.topBtnDom=b.query("#"+this.topBtnId);this.topFlag=(this.topBtnDom!==null)?true:false;this.commentBtnDom=b.query("#"+this.commentBtnId);this.commentConDom=b.query("#"+this.commentConId);this.commentFlag=(this.commentBtnDom.length!==0&&this.commentConDom.length!==0)?true:false;if(this.topFlag||this.commentFlag){this.eventInit()}},eventInit:function(){var c=this;if(c.topFlag){b.on(c.topBtnDom,"click",function(){var g=b.scrollTop(document.body);var h=g/c.moveCounts,d=c.moveTime/c.moveCounts;var f=1;var e=setInterval(function(){if(f<=c.moveCounts){g-=h;scroll(0,g);f++}else{clearInterval(e)}},d)});b.on(window,"scroll",function(){if(b.scrollTop(window)>700){b.show(c.topBtnDom)}else{b.hide(c.topBtnDom)}})}if(c.commentFlag&&!this.isOpen){b.on(c.commentBtnDom,"click",function(){var f=b.offset(c.commentConDom).top,h=b.scrollTop(document.body);var i=(h-f)/c.moveCounts,d=c.moveTime/c.moveCounts;var e=1;var g=setInterval(function(){if(e<=c.moveCounts){h-=i;scroll(0,h);e++}else{clearInterval(g)}},d)})}if(this.isOpen){b.on(c.commentBtnDom,"click",function(){var e=c.detail;var d=c.commentUrl;var f=[];f.push("docUrl="+encodeURIComponent(e.docUrl));f.push("docName="+encodeURIComponent(e.docName));f.push("skey="+encodeURIComponent(e.skey));if(e.speUrl){f.push("speUrl="+encodeURIComponent(e.speUrl))}window.open(d+"?"+f.join("&"),"","")})}}};return a});define("picLazy",["F"],function(c){var e=window;var b=c.height(e);var d=c.query("img.js_lazyImg");var a=function(){var g;var k=c.scrollTop(e);var j;var f;for(var h=d.length-1;h>=0;h--){g=d[h];j=c.offset(g).top;f=c.height(g);if(f!==0&&j>k-f&&j<(k+b)){g.src=c.attr(g,"data-src");g.className="";d.splice(h,1)}}};return a});define("floatIt.pc",["F"],function(b){var c=window;var a=function(h,e){var g=b.offset(h).top;var d=1;var f=false;b.on(c,"scroll",function(){if(f===false&&d===10){d=1;g=b.offset(h).top}if(f===false&&g<b.scrollTop(c)){f=true;b.addClass(h,e)}else{if(g>b.scrollTop(c)&&f===true){f=false;b.removeClass(h,e)}}d++})};return a});define("share.pc",["F"],function(e){var d={params:{contentFlag:true,conShareBtnClass:"js_content_share_btn",selectionFlag:true,imgFlag:true,selShareBtnClass:"js_select_share_btn",selectAreaClass:"js_selection_area",imgShareBtnClass:"js_img_share_btn",imgShareScopeClass:"js_img_share_area",shareAreaId:"js_select_share",imgAreaId:"js_img_share",wxCloseClass:"js_wx_close",wxIframeClass:"js_weixin_iframe",wxConClass:"js_weixin",wxImgClass:"js_wx_qrcod",imgShareDom:null,urls:{longBlog:"http://share.ifeng.com/",qq:"http://v.t.qq.com/share/share.php",qqZone:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey",sina:"http://v.t.sina.com.cn/share/share.php",statistic:"http://stadig.ifeng.com/actsta.js",weixin:"http://qrcode.ifeng.com/qrcode.php"},sinaRalateUid:"1900552512",selectAreaDom:null,shareAreaDom:null,imgAreaDom:null,beforeFn:null,extClassArr:["photoList","ifengLogo","rightBtn","leftBtn","js_sliderBoxOut"]},model:{contentData:null,startFlag:false,moveInFlag:false,imgShareMoveInFlag:false,endFlag:false,qrCodeUrl:""},view:{},ctrl:{}};var g=d.params,a=d.model,b=d.view,h=d.ctrl;g.init=function(c){if(typeof c!=="undefined"){if(typeof c.contentFlag!=="undefined"){g.contentFlag=c.contentFlag}if(typeof c.selectionFlag!=="undefined"){g.selectionFlag=c.selectionFlag}if(typeof c.imgFlag!=="undefined"){g.imgFlag=c.imgFlag}if(typeof c.contentData!=="undefined"){a.contentData=c.contentData}if(typeof c.conShareBtnClass!=="undefined"&&c.conShareBtnClass!==""){g.conShareBtnClass=c.conShareBtnClass}if(typeof c.selShareBtnClass!=="undefined"&&c.selShareBtnClass!==""){g.selShareBtnClass=c.selShareBtnClass}if(typeof c.selectAreaClass!=="undefined"&&c.selectAreaClass!==""){g.selectAreaClass=c.selectAreaClass}if(typeof c.imgShareBtnClass!=="undefined"&&c.imgShareBtnClass!==""){g.imgShareBtnClass=c.imgShareBtnClass}if(typeof c.shareAreaId!=="undefined"&&c.shareAreaId!==""){g.shareAreaId=c.shareAreaId}if(typeof c.sinaRalateUid!=="undefined"&&c.sinaRalateUid!==""){g.sinaRalateUid=c.sinaRalateUid}if(typeof c.urls!=="undefined"){if(typeof c.urls.qq!=="undefined"&&c.urls.qq!==""){g.urls.qq=c.urls.qq}if(typeof c.urls.qqZone!=="undefined"&&c.urls.qqZone!==""){g.urls.qqZone=c.urls.qqZone}if(typeof c.urls.sina!=="undefined"&&c.urls.sina!==""){g.urls.sina=c.urls.sina}if(typeof c.urls.weixin!=="undefined"&&c.urls.weixin!==""){g.urls.weixin=c.urls.weixin}}}g.selectAreaDom=e.query("."+g.selectAreaClass);if(e.query("."+g.conShareBtnClass).length===0){g.contentFlag=false}if(typeof a.contentData==="undefined"||c.contentData===null){g.contentFlag=false}if(e.query("#"+g.shareAreaId).length===0){g.selectionFlag=false}if(g.selectAreaDom.length===0){g.selectionFlag=false}if(e.query("#"+g.imgAreaId).length===0){g.imgFlag=false}if(!g.contentFlag&&!g.selectionFlag&&!g.imgFlag){return false}g.shareAreaDom=e.query("#"+g.shareAreaId)[0];g.imgAreaDom=e.query("#"+g.imgAreaId)[0];return true};a.getSelectionText=function(){if(window.getSelection){return window.getSelection().toString()}else{if(document.selection&&document.selection.createRange){return document.selection.createRange().text}}return""};a.setSelectionEmpty=function(){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.body&&document.body.createTextRange){document.selection.empty()}}};a.getStatisticUrlByType=function(c,j){var i;if(a.opeOfUrl("param",c,"_share")!==null){c=a.opeOfUrl("param",c,"_share",j)}else{if(c.split("?").length===1){c=c+"?_share="+j}else{if(a.opeOfUrl("param",c,"_share")!==null){c=a.opeOfUrl("param",c,"_share",j)}else{i=c.split("#");i[0]=i[0]+"&_share="+j;c=i.join("#")}}}return c};a.isIE67=function(){var c=navigator.userAgent.toLowerCase();var j={expStr:/(msie)[ |\/]*(\d*[.\d*]*)/i,name:"msie"};var i=c.match(j.expStr);if(i instanceof Array&&i.length>1&&i[1]===j.name){if(i[2]==="6.0"||i[2]==="7.0"){return true}}return false};a.sendStatisticInfo=function(i){var c=g.urls.statistic;e.ajax({url:c,data:i,cache:true,dataType:"script"})};a.opeOfStr=function(l,i,k){var j=null;if(typeof l!=="undefined"){var c=l.split("&");if(l===""&&typeof k!=="undefined"){j=i+"="+k}else{e.each(c,function(n,o){var m=o.split("=");if(m[0]===i){if(typeof k==="undefined"){j=m[1]}else{c[n]=i+"="+k;j=c.join("&")}return false}else{if(n===c.length-1&&typeof k!=="undefined"){j=l+"&"+i+"="+k}}})}}return j};a.opeOfHash=function(i,c,k){var j=null;if(typeof i!=="undefined"){if(i.indexOf("#")===0){i=i.substr(1)}var l=i.split("#");e.each(l,function(n,o){var m=a.opeOfStr(o,c);if(typeof k==="undefined"){if(m!==null){j=m;return false}}else{if(m!==null){l[n]=a.opeOfStr(o,c,k);j="#"+l.join("#");return false}else{if(m===null&&n===l.length-1){if(i===""){j="#"+c+"="+k}else{j="#"+i+"&"+c+"="+k}return false}}}})}return j};a.opeOfParam=function(i,c,k){var j=null;if(typeof i!=="undefined"){if(i.indexOf("?")===0){i=i.substr(1)}if(typeof k==="undefined"){j=a.opeOfStr(i,c)}else{j="?"+a.opeOfStr(i,c,k)}}return j};a.opeOfUrl=function(o,c,i,k){var p=null;if(typeof c!=="undefined"){var l=c.indexOf("#"),n=c.indexOf("?");if(o==="hash"){if(l===-1){l=c.length}var r=c.substr(l),q=c.substring(0,l);if(typeof k==="undefined"){p=a.opeOfHash(r,i)}else{p=q+a.opeOfHash(r,i,k)}}else{if(o==="param"){var m,r,j;if(n===-1&&l===-1){m="";r="";j=c}else{if(n>-1&&l===-1){m=c.substr(n);r="";j=c.substr(0,n)}else{if(n===-1&&l>-1){m="";r=c.substr(l);j=c.substr(0,l)}else{if(n>l){m="";r=c.substr(l);j=c.substr(0,l)}else{m=c.substring(n,l);r=c.substr(l);j=c.substr(0,n)}}}}if(typeof k==="undefined"){p=a.opeOfParam(m,i)}else{p=j+a.opeOfParam(m,i,k)+r}}}}return p};a.getWeixinQRCode=function(i,c){e.ajax({url:g.urls.weixin,dataType:"jsonp",data:i,success:c})};h.init=function(c){if(g.init(c)){h.eventInit()}};h.shareContent=function(j){if(typeof j!=="undefined"){var c="";j.title=encodeURIComponent(j.title);var o={};if(j.type==="sina"){c=g.urls.sina;o.url=j.url;o.title=j.title;o.pic=j.pic;o.searchPic=false;o.appkey="2512457640";o.ralateUid=d.params.sinaRalateUid;o.rcontent=encodeURIComponent("");o.source="ifeng"}else{if(j.type==="qq"){c=g.urls.qq;o.url=j.url;o.title=j.title;o.pic=j.pic;o.site=encodeURIComponent(window.location.host);o.appkey="801cf76d3cfc44ada52ec13114e84a96";o.rcontent=encodeURIComponent("")}else{if(j.type==="qqZone"){c=g.urls.qqZone;o.title=j.title;o.url=j.url;o.pics=j.pic}}}var q=[];var k=new Date();k.setHours(0);k.setMinutes(0);k.setSeconds(0);k.setMilliseconds(0);o.url+="?tp="+k.getTime()+"&_share_"+j.type;for(var p in o){q.push(p+"="+o[p])}c+="?"+q.join("&");var l=600,m=450;var n=(window.screen.availHeight-30-m)/2,s=(window.screen.availWidth-10-l)/2;var r="scrollbars=no,width="+l+",height="+m+",left="+s+",top="+n+",status=no,resizable=yes";window.open(c,"_blank",r)}};h.sendStatisticInfo=function(i){var c={};c.datatype="share";c.value=i;var k=e.query("script");c.ref="";e.each(k,function(n,q){if(q.src.indexOf("http://stadig.ifeng.com/page.js")>-1){var p=a.opeOfUrl("param",q.src,"ref");c.ref=(p!==null)?p:"";var o=a.opeOfUrl("param",q.src,"uid");c.uid=(o!==null)?o:"";var m=a.opeOfUrl("param",q.src,"sid");c.sid=(o!==null)?m:""}});var j=window.location.href,l=window.location.hash;if(a.opeOfUrl("param",j,"_share")!==null){c.uri=a.opeOfUrl("param",j,"_share",i)}else{if(l===""){c.uri=j+"#_share="+i}else{if(a.opeOfUrl("hash",j,"_share")!==null){c.uri=a.opeOfUrl("hash",j,"_share",i)}else{c.uri=a.opeOfUrl("param",j,"_share",i)}}}c.time=new Date().getTime();if(typeof getChannelInfo!=="undefined"){c.ci=getChannelInfo()}if(typeof getStaPara==="function"){c.pt=getStaPara()}a.sendStatisticInfo(c)};h.eventInit=function(){var c=h.process;if(g.contentFlag){e.on(e.query("."+g.conShareBtnClass),"click",function(){c.contentShare(this);return false});e.on("."+g.wxCloseClass,"click",function(){h.weixinShare(e.parent(e.parent(this)))})}if(g.selectionFlag){if(a.isIE67()){e.css(g.selectAreaDom,{position:"relative",zoom:1})}e.on(g.selectAreaDom,"mouseover",function(){c.mouseover()});e.on(g.selectAreaDom,"mouseout",function(i){c.mouseout(i,this)});e.on(g.selectAreaDom,"mouseup",function(i){c.mouseup(i);if(a.startFlag&&a.endFlag&&a.moveInFlag&&a.getSelectionText()!==""){return false}});e.on(g.selectAreaDom,"mousedown",function(i){c.hideShareArea();c.mousedown(i)});e.on("body","mouseup",function(){c.hideShareArea()});e.on(g.shareAreaDom,"click",function(){c.selectionShare(this);return false},{delegate:"."+g.selShareBtnClass})}if(g.imgFlag){e.on("."+g.imgShareScopeClass,"mouseover",function(){c.moveInImg(this)},{delegate:"img"});e.on("."+g.imgShareScopeClass,"mouseout",function(i){c.moveOutImg(i,this)},{delegate:"img"});e.on("body","click",function(){c.imgShare(this);return false},{delegate:"."+g.imgShareBtnClass})}};h.weixinShare=function(j){var p=e.parent(e.parent(j));var l=e.find(p,"."+g.wxConClass)[0],c=e.find(p,"."+g.wxIframeClass)[0],m=e.query(".main");var n=e.attr(l,"data-lockFlag"),k=e.attr(l,"data-showFlag");if(n===null||n==="unlock"){e.attr(l,"data-lockFlag","lock");if(k===null||k==="hide"){h.sendStatisticInfo("weixin");e.css(".js_titleName",{zIndex:101});var o=function(){e.addClass(m,"main_wx");e.show(c);e.show(l);e.animate(c,{height:"100px"},400);e.animate(l,{height:"114px"},400,{callback:function(){e.animate(l,{height:"111px"},100,{callback:function(){e.animate(l,{height:"112px"},100,{callback:function(){e.css(c,{height:"100px"});e.attr(l,"data-showFlag","show");e.attr(l,"data-lockFlag","unlock")}})}})}})};if(a.qrCodeUrl!==""){o()}else{var i={};i.url=a.getStatisticUrlByType(a.contentData.docUrl,"weixin");a.getWeixinQRCode(i,function(q){a.qrCodeUrl=q.qrcode_url;e.attr("."+g.wxImgClass,"src",a.qrCodeUrl);o()})}}else{e.attr(l,"data-lockFlag","lock");e.css(".js_titleName",{zIndex:103});e.animate(l,{height:"0px"},400,{callback:function(){e.attr(l,"data-showFlag","hide");e.attr(l,"data-lockFlag","unlock");e.hide(l)}});e.animate(c,{height:"0px"},400,{callback:function(){e.hide(c)}});e.removeClass(m,"main_wx")}}};h.process={};h.process.imgShare=function(n){var i=e.attr(n,"data-type");if(typeof i==="undefined"||i===""){return}h.sendStatisticInfo(i);if(g.imgShareDom!==null){var c="",j=e.attr(g.imgShareDom,"alt"),m=e.attr(g.imgShareDom,"title"),l=e.attr(g.imgShareDom,"src");if(j!==null){c+=j}if(c===""&&m!==null){c+=m}var k={};k.type=i;k.pic=(l!==null)?l:"";k.title=c;k.url=window.location.href;h.shareContent(k)}};h.process.moveInImg=function(k){var q=k;var o=function(t){var s=false;e.each(g.extClassArr,function(u,v){if(e.hasClass(t,v)){s=true;return}});return s};while(!o(q)&&q){try{q=q.parentNode}catch(p){break}}if(!o(q)){e.show(g.imgAreaDom);g.imgShareDom=k;var l=e.offset(k),c=e.width(k),r=e.height(k),i=e.width(g.imgAreaDom),m=e.height(g.imgAreaDom);var n=l.top+(r-m-10),j=l.left+(c-i-11);e.css(g.imgAreaDom,{top:n+"px",left:j+"px"})}};h.process.moveOutImg=function(j){var i=j.relatedTarget||j.toElement;while(i!==g.imgAreaDom&&i){try{i=i.parentNode}catch(c){break}}if(i!==g.imgAreaDom){e.hide(g.imgAreaDom);g.imgShareDom=null}};h.process.contentShare=function(k){var o=e.attr(k,"data-type"),l=a.contentData,n=[];if(o!=="weixin"){h.sendStatisticInfo(o);var i=600,j=450;var m=(window.screen.availHeight-30-j)/2,q=(window.screen.availWidth-10-i)/2;var p="scrollbars=no,width="+i+",height="+j+",left="+q+",top="+m+",status=no,resizable=yes";n.push("type="+encodeURIComponent(o));n.push("title="+encodeURIComponent("【"+l.docName+"】"+l.summary));var c=a.getStatisticUrlByType(l.docUrl,o);n.push("url="+encodeURIComponent(c));n.push("pic="+encodeURIComponent(l.image));n.push("sinaRalateUid="+encodeURIComponent(g.sinaRalateUid));window.open("http://h0.ifengimg.com/commonpage/0304/share_open.html?"+n.join("&"),"_blank",p)}else{h.weixinShare(k)}};h.process.selectionShare=function(k){var c=e.attr(k,"data-type"),i=a.contentData;if(typeof c==="undefined"||c===""){return}h.sendStatisticInfo(c);var j={};j.type=c;j.pic=(typeof i.image!=="undefined"&&i.image!=="")?i.image:"";j.title=a.getSelectionText();j.url=window.location.href;h.shareContent(j)};h.process.hideShareArea=function(){e.hide(g.shareAreaDom)};h.process.mousedown=function(c){a.startFlag=true;if(c.button===0){a.setSelectionEmpty()}};h.process.mouseup=function(i){a.endFlag=true;if(a.startFlag&&a.endFlag&&a.moveInFlag){if(a.getSelectionText()!==""){var k=i||window.event;var l=document.documentElement.scrollLeft||document.body.scrollLeft,j=document.documentElement.scrollTop||document.body.scrollTop;var c=k.pageX||k.clientX+l,m=k.pageY||k.clientY+j;e.css(g.shareAreaDom,{top:(m+10)+"px",left:(c-50)+"px"});e.show(g.shareAreaDom)}}};h.process.mouseover=function(){a.moveInFlag=true};h.process.mouseout=function(j,k){var i=j.relatedTarget||j.toElement;while(i!==k&&i){try{i=i.parentNode}catch(c){break}}if(i!==k){a.endFlag=false;a.startFlag=false;a.moveInFlag=false}};h.beforeShare=function(c){g.beforeFn=c};var f={beforeShare:h.beforeShare,init:h.init};return f});
